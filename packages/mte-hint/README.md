# åŸºäºå¯Œæ–‡æœ¬ç¼–è¾‘å™¨çš„$å…³é”®å­—å˜é‡æ™ºèƒ½åŒ¹é…åŠŸèƒ½

å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼ŒMulti-function Text Editor, ç®€ç§° MTE, æ˜¯ä¸€ç§å¯å†…åµŒäºæµè§ˆå™¨ï¼Œå¯ä»¥å¯¹æ–‡å­—ã€å›¾ç‰‡ç­‰è¿›è¡Œç¼–è¾‘çš„ï¼Œæ‰€è§å³æ‰€å¾—çš„æ–‡æœ¬ç¼–è¾‘å™¨ã€‚

<!-- ç›®å‰ï¼Œå¸‚é¢ä¸Šå¤§å¤šå¯Œæ–‡æœ¬ç¼–è¾‘å™¨æ˜¯ä¾é æµè§ˆå™¨æä¾›çš„contenteditableä»¥åŠexecCommandè¿™ä¸¤å¤§åŸç”Ÿçš„APIå®ç°çš„ã€‚
ï¼Œwangeditoråˆ™æ˜¯å…¶ä¸­ä¹‹ä¸€é¦–å…ˆï¼Œå°†å¤–éƒ¨å®¹å™¨ï¼ˆä¸€èˆ¬ä¸ºdivï¼‰çš„contenteditableå±æ€§è®¾ç½®ä¸ºtrueï¼Œè¯¥å®¹å™¨ä¸­å°±å¯ä»¥è¿›è¡Œé”®ç›˜ã€é¼ æ ‡ç­‰æ“ä½œäº†ã€‚å¦å¤–ï¼Œæ·»åŠ ä¸€ä¸ªå·¥å…·æ ï¼ˆtoolbarï¼‰ï¼Œå€ŸåŠ© execCommand å‘½ä»¤ï¼Œå®ç°å¯¹å®¹å™¨ä¸­å†…å®¹çš„ç¼–è¾‘åŠŸèƒ½ï¼Œæ¯”å¦‚ï¼šæ–‡å­—åŠ ç²—ã€æ–œä½“ã€ä¸‹åˆ’çº¿åŠŸèƒ½ç­‰ã€‚
ä½†æ˜¯ï¼Œå¯ä»¥å‘ç°çš„æ˜¯åŸºäºè¿™ç§æ–¹æ¡ˆçš„å¯Œæ–‡æœ¬ç¼–è¾‘å™¨åŠŸèƒ½éƒ½æ¯”è¾ƒåŸºç¡€ä¸”æœ‰é™ï¼Œå¯¹äºæŒ‡å®šå…³é”®å­—çš„è§¦å‘æ— æ³•å®ç°ï¼Œä»¥åŠæ ¹æ®é”®ç›˜è¾“å…¥çš„å†…å®¹è¿›è¡ŒåŠ¨æ€çš„å˜é‡åŒ¹é…ä¹Ÿæœªæœ‰å®ç°ï¼Œè€ŒåŸºäºæ­¤é€»è¾‘è¿›ä¸€æ­¥å®ç°çš„æ™ºèƒ½æç¤ºåŒ¹é…æ›´æ˜¯åŠŸèƒ½æ›´æ˜¯æ²¡æœ‰ã€‚ -->

## å‰è¨€

å‰æ®µæ—¶é—´ï¼Œæ¥åˆ°ä¸€ä¸ªéœ€æ±‚ï¼Œå®ç°ä¸€ä¸ªé‚®ä»¶çš„æ¨¡æ¿ç¼–è¾‘åŠŸèƒ½ï¼Œå¯¹äºå‰ç«¯æ¥è¯´ï¼Œå°±æ˜¯ç”¨æˆ·å¯ä»¥åœ¨ç°æœ‰çš„å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ä¸­æ’å…¥å˜é‡ï¼Œå…·ä½“è¡¨ç°å°±æ˜¯ï¼š

1. åœ¨ç¼–è¾‘å™¨ä¸­é€šè¿‡ `$` å…³é”®å­—è§¦å‘ï¼Œå¼¹å‡ºä¸€ä¸ªç±»ä¼¼ Select é€‰æ‹©æ¡†çš„å¼¹çª—ï¼Œæä¾›é€‰æ‹©æŒ‡å®šå˜é‡
2. åœ¨é€‰æ‹©å˜é‡ä¹‹åï¼Œåœ¨ç¼–è¾‘å™¨ä¸­ä»¥ `${xx}` è¿™ç§å½¢å¼ä¿å­˜ï¼Œå¹¶ä¸”ä»¥ä¸åŒé¢œè‰²é«˜äº®åŒºåˆ«

ä¸šåŠ¡ä¸Šçš„è¡¨ç°æ˜¯è¿™æ ·çš„ï¼Œåœ¨é€»è¾‘è§¦å‘æ—¶ï¼Œåç«¯é€šè¿‡ `${xx}` å»ç­›é€‰æ›¿æ¢å˜é‡ä¸ºå¯¹åº”çš„å€¼ï¼Œç„¶åå‘é€é‚®ä»¶åˆ°å¯¹åº”çš„ç”¨æˆ·ã€‚

## åŠŸèƒ½å®ç°

ä¸ºäº†æ–¹ä¾¿ç”¨æˆ·çš„ä½¿ç”¨ï¼Œæˆ‘ä»¬ç›®å‰è®¾è®¡äº†è¿™å‡ ä¸ªåŠŸèƒ½ç‚¹ï¼š

1. åœ¨ä¸å½±å“å¯Œæ–‡æœ¬ç¼–è¾‘å™¨çš„åŸºæœ¬åŠŸèƒ½ä¸‹ï¼Œé€šè¿‡æŒ‰é”® `$` è§¦å‘é€‰æ‹©æ¡†å¼¹å‡º
2. é€‰ä¸­çš„åˆ—è¡¨é¡¹ï¼Œä¼šä»¥ `${xx}` è¿™ç§å½¢å¼è‡ªåŠ¨æ’å…¥åˆ°ç¼–è¾‘å™¨çš„å½“å‰é€‰åŒºä¸­
3. æ’å…¥åˆ°ç¼–è¾‘å™¨ä¸­çš„å˜é‡ä»¥ `${xx}` è¿™ç§å½¢å¼ä¿å­˜ï¼Œå¹¶ä¸”æ”¯æŒé«˜äº®æ˜¾ç¤º
4. æ”¯æŒ `${xx}` ä¸­å˜é‡çš„åŠ¨æ€æ¨¡ç³ŠæŸ¥è¯¢ï¼ˆä¾‹å¦‚ï¼šå½“ä½ åœ¨ `${}` ä¸­è¾“å…¥ `send` æ—¶ï¼Œåˆ—è¡¨ä¸­çš„ `sendTime`ã€`sendCount` åº”è¯¥æ˜¯åŒ¹é…åœ¨åˆ—è¡¨ä¸­çš„ ï¼‰
5. æ”¯æŒå¯¹ `${xx}` çš„å˜é‡è¯†åˆ«å“åº”ï¼ˆä¾‹å¦‚ï¼šå…‰æ ‡ä»å…¶ä»–ä½ç½®ç§»åŠ¨åˆ° `${}` ä¸­æ—¶ï¼Œä¼šå®æ—¶åœ°å“åº”åŒ¹é…å…¶ä¸­çš„å˜é‡ï¼‰

## $ å…³é”®å­—è§¦å‘

å¦‚ä½•ç›‘å¬ `$` å…³é”®å­—ï¼Œè¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œé€šè¿‡ç›‘å¬é”®ç›˜äº‹ä»¶å°±å¯ä»¥å®ç°ï¼Œåœ¨åŒ¹é…åˆ° `$` æ—¶ï¼Œè§¦å‘å¯¹åº”é€»è¾‘å³å¯ï¼Œä¸è¿‡ï¼Œè¿™é‡Œé‡ç‚¹å…¶å®æ˜¯å®ç° `${}`ã€‚

> å˜é‡éœ€è¦ä»¥ `${xx}` è¿™ç§å½¢å¼ä¿å­˜ï¼Œè€Œä¸”å‰ç«¯ä¹Ÿéœ€è¦é€šè¿‡ `{}` å»éš”ç¦»åŒä¸€è¡Œå†…çš„å…¶ä»–å˜é‡ï¼Œä»è€ŒåŒºåˆ†å½“å‰å˜é‡ã€‚

åœ¨æ£€æµ‹åˆ° `$` å­—ç¬¦æ—¶ï¼Œè‡ªåŠ¨æŠŠ `{}` æ‹¼æ¥ä¸Šï¼Œå¹¶ä¸”æŠŠå…‰æ ‡ç§»åŠ¨åˆ° `${}` ä¹‹ä¸­ã€‚

è¿™é‡Œæˆ‘ä»¥å…¬å¸ä½¿ç”¨çš„ wangeditor v4 ç‰ˆæœ¬ä¸ºä¾‹ï¼Œä¸è¿‡ï¼Œæœ¬æ–‡æ‰€æåˆ°çš„åŠŸèƒ½å®ç°ä¸å±€é™äºæŸä¸€å›ºå®šæ¡†æ¶ï¼Œä¸»è¦æ˜¯åŸºäºåŸç”Ÿå®ç°ã€‚

åœ¨æ­¤ï¼Œå»ºè®®å…ˆäº†è§£ä¸‹ é€‰åŒºï¼ˆSelectionï¼‰å’ŒèŒƒå›´ï¼ˆRangeï¼‰çš„åŸºæœ¬æ¦‚å¿µ ï¼ˆå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« [åˆ©ç”¨ javascript å®ç°å¯Œæ–‡æœ¬ç¼–è¾‘å™¨](https://juejin.cn/post/6844903508446019597)ï¼‰

### Rangeå¯¹è±¡çš„ç®€è¦ä»‹ç»

> è¿™é‡Œä¸ºäº†æ–¹ä¾¿ä¸äº†è§£çš„åŒå­¦èƒ½å¤Ÿæ›´æœ‰æ•ˆçš„é˜…è¯»ï¼Œæˆ‘ç®€å•æ¦‚è¿°ä¸‹ï¼Œä¸è¿‡ï¼Œè¯¦ç»†çš„å±æ€§æ–¹æ³•è¿˜è¯·è‡ªè¡Œäº†è§£ã€‚

ä½œä¸ºå¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼Œå¼€å‘è€…éœ€è¦æœ‰èƒ½åŠ›æ§åˆ¶å…‰æ ‡çš„å„ç§çŠ¶æ€ä¿¡æ¯ï¼Œä½ç½®ä¿¡æ¯ç­‰ã€‚æµè§ˆå™¨æä¾›äº† `selection` å¯¹è±¡å’Œ `range` å¯¹è±¡æ¥æ“ä½œå…‰æ ‡ã€‚

```js
let selection = window.getSelection();
```

é€šå¸¸æƒ…å†µä¸‹æˆ‘ä»¬ä¸ä¼šç›´æ¥æ“ä½œ `selection` å¯¹è±¡ï¼Œè€Œæ˜¯éœ€è¦æ“ä½œç”¨ `seleciton` å¯¹è±¡æ‰€å¯¹åº”çš„ç”¨æˆ·é€‰æ‹©çš„ `ranges` (åŒºåŸŸ)ï¼Œä¿—ç§°â€æ‹–è“â€œ

```js
let range = selection.getRangeAt(0);
```

ç”±äºæµè§ˆå™¨å½“å‰å¯èƒ½å­˜åœ¨å¤šä¸ªæ–‡æœ¬é€‰å–ï¼Œæ‰€ä»¥ `getRangeAt` å‡½æ•°æ¥å—ä¸€ä¸ªç´¢å¼•å€¼ã€‚åœ¨å¯Œæ–‡æœ¬ç¼–è¾‘å…¶ä¸­ï¼Œæˆ‘ä»¬ä¸è€ƒè™‘å¤šé€‰å–çš„å¯èƒ½æ€§ã€‚

selection å¯¹è±¡è¿˜æœ‰ä¸¤ä¸ªé‡è¦çš„æ–¹æ³•ï¼Œ `addRange` å’Œ `removeAllRanges`ã€‚åˆ†åˆ«ç”¨äºå‘å½“å‰é€‰å–æ·»åŠ ä¸€ä¸ª `range` å¯¹è±¡å’Œ åˆ é™¤æ‰€æœ‰ `range` å¯¹è±¡ã€‚

----

ä¾‹å¦‚å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ä¸­æœ‰è¿™ä¹ˆä¸€æ®µå†…å®¹ï¼š

`ç™¾åº¦EUXå›¢é˜Ÿ`

é‚£ä¹ˆåœ¨å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ä¸­çš„DOMç»“æ„å°±æ˜¯è¿™æ ·ï¼š

```html
<p>ç™¾åº¦EUXå›¢é˜Ÿ</p>
```

#### 1.å…‰æ ‡ä½ç½®ï¼ˆæ— æ‹–é€‰ï¼‰

![å…‰æ ‡ä½ç½®ï¼ˆæ— æ‹–é€‰ï¼‰](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/11/3/aefdf72accf2841e45ccfe858642e5a7~tplv-t2oaga2asx-jj-mark:3024:0:0:0:q75.awebp)

æ‰“å°å‡ºæ­¤æ—¶çš„ range å¯¹è±¡ï¼š

![range å¯¹è±¡](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/11/3/95ffae17dd99f65ec3fa57dc01d30182~tplv-t2oaga2asx-jj-mark:3024:0:0:0:q75.awebp)

å…¶ä¸­å±æ€§å«ä¹‰å¦‚ä¸‹ï¼š

- startContainer: range èŒƒå›´çš„èµ·å§‹èŠ‚ç‚¹ã€‚
- endContainer: range èŒƒå›´çš„ç»“æŸèŠ‚ç‚¹
- startOffset: range èµ·ç‚¹ä½ç½®çš„åç§»é‡ã€‚
- endOffset: range ç»ˆç‚¹ä½ç½®çš„åç§»é‡ã€‚
- commonAncestorContainer: è¿”å›åŒ…å« startContainer å’Œ endContainer çš„æœ€æ·±çš„èŠ‚ç‚¹ã€‚
- collapsed: è¿”å›ä¸€ä¸ªç”¨äºåˆ¤æ–­Range èµ·å§‹ä½ç½®å’Œç»ˆæ­¢ä½ç½®æ˜¯å¦ç›¸åŒçš„å¸ƒå°”å€¼ã€‚

è¿™é‡Œæˆ‘ä»¬çš„ startContainer , endContainer, commonAncestorContaineréƒ½ä¸º #text æ–‡æœ¬èŠ‚ç‚¹ â€˜ç™¾åº¦EUXå›¢é˜Ÿâ€™ã€‚å› ä¸ºå…‰æ ‡åœ¨â€˜åº¦â€˜å­—åé¢ï¼Œæ‰€ä»¥startOffset å’Œ endOffset å‡ä¸º 2ã€‚ä¸”æ²¡æœ‰äº§ç”Ÿæ‹–è“ï¼Œæ‰€ä»¥ collapsed çš„å€¼ä¸º trueã€‚æˆ‘ä»¬å†çœ‹ä¸€ä¸ªäº§ç”Ÿæ‹–è“çš„ä¾‹å­ï¼š

#### 2.å…‰æ ‡ä½ç½®ï¼ˆæœ‰æ‹–é€‰ï¼‰

![å…‰æ ‡ä½ç½®ï¼ˆæœ‰æ‹–é€‰ï¼‰](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/11/3/99754c9c079ef1ea9d87bdd30cb34ce3~tplv-t2oaga2asx-jj-mark:3024:0:0:0:q75.awebp)

æ‰“å°å‡ºæ­¤æ—¶çš„ range å¯¹è±¡ï¼š

![range å¯¹è±¡](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/11/3/0b0a935ad4c002261eca6866fee414e1~tplv-t2oaga2asx-jj-mark:3024:0:0:0:q75.awebp)

ç”±äºäº§ç”Ÿäº†æ‹–è“ startContainer å’Œ endContainer ä¸å†ä¸€è‡´ï¼Œcollapsed çš„å€¼å˜ä¸ºäº† falseã€‚startOffset å’Œ endOffset æ­£å¥½ä»£è¡¨äº†æ‹–è“çš„èµ·ç»ˆä½ç½®

### é¡µé¢ä»£ç åŸºæœ¬ç»“æ„

DOMç»“æ„

```html
<template>
  <div class="box">
    <!-- ç¼–è¾‘å™¨ -->
    <div class="editorâ€”wrapper">
      <div id="toolbar-container"><!-- å·¥å…·æ  --></div>
      <div id="text-container"><!-- ç¼–è¾‘å™¨ --></div>
    </div>
    <!-- å¼¹çª— -->
    <div ref="tipRef" v-show="isShow" class="tip-wrap">æˆ‘æ˜¯å¼¹çª—</div>
  </div>
</template>
```

JSç›¸å…³ä»£ç 

```js
import { onMounted, ref, shallowRef } from 'vue'
import E from 'wangeditor'

// wangeditorç¼–è¾‘å™¨å®ä¾‹
const editor = shallowRef()
// ç¼–è¾‘å™¨DOM
const editorBox = shallowRef()
// å¼¹çª—DOM
const tipRef = shallowRef()
// å¼¹çª—å¼€å…³
const isShow = ref(false)

// Mounted
onMounted(() => {
  editorBox.value = document.getElementById('text-container')

  initEditor()
  initEvents()
})

function initEditor() {
  editor.value = new E('#toolbar-container', '#text-container')
  editor.value.create()
}

function initEvents() {
  // ç‚¹å‡»éå¼¹çª—åŒºåŸŸï¼Œå…³é—­å¼¹çª—
  window.addEventListener('click', windowClickClose)
  // è¿™é‡Œéœ€è¦ä½¿ç”¨ keyup é”®ç›˜äº‹ä»¶ï¼ˆ${}ï¼‰ï¼Œkeydown äº‹ä»¶åœ¨å¤„ç†$å…³é”®å­—æ—¶ä¼šå¯¼è‡´ {$} ä½ç½®é”™è¯¯
  window.addEventListener('keyup', onWindowKeyUp, true)
  // selection
  document.addEventListener('selectionchange', selectionchange)
  // åœ¨å¼¹çª—å¼€å¯æ—¶ï¼Œé˜»æ­¢å¯¹åº”é”®ç›˜æ“ä½œå½±å“ç¼–è¾‘å™¨
  document.addEventListener('keydown', onWindowKeyDown)
}
```

### ç»‘å®škeyupäº‹ä»¶

```js
window.addEventListener('keyup', onWindowKeyUp, true)

// ä½¿ç”¨é˜²æŠ–å‡½æ•° debounce é¿å…é‡å¤æ’å…¥
const onWindowKeyUp = debounce((ev) => {
  // console.log('key', ev.key)
  const key = ev.key

  if (key === '$') {
    // isShow.value=true
    const selection = document.getSelection()
    const range = selection.getRangeAt(0)
    const textNode = range.startContainer
    // è·å–å…‰æ ‡ä½ç½®
    const rangeStartOffeset = range.startOffset
    // åœ¨ $ åé¢æ’å…¥ {}
    textNode.insertData(rangeStartOffeset, '{}') 
    // ç§»åŠ¨å…‰æ ‡ä½ç½®
    range.setStart(textNode, rangeStartOffeset + 1)
    range.collapse(true)
    selection.removeAllRanges()
    // æ’å…¥æ–°çš„å…‰æ ‡å¯¹è±¡
    selection.addRange(range)
  }
}, 10)
```

ç›®å‰è¯¥å‡½æ•°å¯ä»¥å®ç°åœ¨æŒ‰ä¸‹ `$` æŒ‰é”®åï¼Œè¾“å…¥ `${}` å¹¶ä¸”å…‰æ ‡åœ¨èŠ±æ‹¬å·ä¹‹ä¸­ã€‚

æŒ‰ç…§è®¾æƒ³ï¼Œè¿™æ—¶åº”è¯¥å†è‡ªåŠ¨è§¦å‘ `isShow.value=true`ï¼Œå¼€å¯å¼¹çª—çš„é€»è¾‘ï¼Œä½†æ˜¯ï¼Œå› ä¸ºåœ¨åé¢çš„å®è·µè¿‡ç¨‹ä¸­ï¼Œå‘ç°è¿™ç§æ–¹å¼å¹¶ä¸å¥½ï¼Œæ¶‰åŠåˆ°ç”¨æˆ·ä½“éªŒçš„é—®é¢˜ï¼Œç›¸åº”çš„é€»è¾‘è¯·å¾€ä¸‹çœ‹ã€‚

## é€‰ä¸­é¡¹è‡ªåŠ¨æ’å…¥åˆ°ç¼–è¾‘å™¨ä¸­

é€‰ä¸­çš„åˆ—è¡¨é¡¹ï¼Œä¼šä»¥ `${xx}` è¿™ç§å½¢å¼è‡ªåŠ¨æ’å…¥åˆ°ç¼–è¾‘å™¨çš„å½“å‰é€‰åŒºä¸­

ç®€å•ç”»ä¸€ä¸‹åˆ—è¡¨ç»“æ„ï¼š

```html
<!-- å¼¹çª— -->
<div ref="tipRef" v-show="isShow" class="tip-wrap">
  <ol>
    <li 
      v-for="item in listData" 
      :key="item.value" 
      :data-value="item.value"
    >
      {{ `${item.label}(${item.value})` }}
    </li>
  </ol>
</div>
```

ä¸ºäº†ä¼˜åŒ–æ€§èƒ½ï¼Œæˆ‘ä»¬æŠŠç‚¹å‡»äº‹ä»¶æ‰˜ç®¡åœ¨å¤–å±‚DOMä¸Š

```js
// åˆ—è¡¨ç‚¹å‡»äº‹ä»¶
if (tipRef.value) {
  tipRef.value.addEventListener('click', onOlClick, true)
}

function onOlClick(ev) {
  const { value } = ev.target.dataset
  console.log('value', value)
}
```

ç‚¹å‡»é€‰æ‹©è¿™ç±»åŸºæœ¬åŠŸèƒ½ä¸åšè¿‡å¤šé˜è¿°ï¼Œè¿™é‡Œä¸»è¦è¯´æ˜ä¸‹å¦‚ä½•ä»¥ `${xx}` è¿™ç§å½¢å¼è‡ªåŠ¨æ’å…¥åˆ°ç¼–è¾‘å™¨çš„å½“å‰é€‰åŒºä¸­

### document.execCommand æ–¹æ³•

å½“ä¸€ä¸ªdivå…ƒç´ è¢«æ·»åŠ `contenteditable`å±æ€§ä¸”ä¸ºtrueæ—¶ï¼Œè¡¨ç¤ºå…ƒç´ å¯è¢«ç”¨æˆ·ç¼–è¾‘ï¼ˆå¯Œæ–‡æœ¬ç¼–è¾‘å™¨çš„åŸºæœ¬é€»è¾‘ï¼‰

è¯¥å‘½ä»¤æ˜¯æµè§ˆå™¨æä¾›çš„APIï¼Œç”¨äºé…åˆè¢«`contenteditable`çš„å…ƒç´ ï¼Œè¯¥æ–¹æ³•å…è®¸è¿è¡Œå‘½ä»¤æ¥æ“çºµå¯ç¼–è¾‘å†…å®¹åŒºåŸŸçš„å…ƒç´ ã€‚

> document.execCommand è¯¥æ–¹æ³•è™½ç„¶ä¸»æµæµè§ˆå™¨éƒ½æ”¯æŒï¼Œä½†ç°åœ¨å®˜æ–¹å·²ä¸å†æ¨èä½¿ç”¨ï¼Œç›¸å…³åˆ†æå¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« [ğŸ‰ å¯Œæ–‡æœ¬ç¼–è¾‘å™¨åˆæ¢](https://juejin.cn/post/6955335319566680077)
>
> åˆ†ææºç å¯çŸ¥ï¼Œwangeditor v4ç‰ˆæœ¬åŠä»¥ä¸‹æ˜¯åŸºäºè¯¥å±æ€§æ–¹æ³•å®ç°çš„ï¼Œè€Œ v5.x ç‰ˆæœ¬å†…æ ¸å·²ç»å®Œå…¨é‡æ„ï¼Œç°åœ¨æ˜¯åŸºäº slate.js å¼€å‘çš„

è¿™é‡Œæˆ‘ä»¬è¿˜æ˜¯ä»¥è¿™ä¸ªæ–¹æ¡ˆç¼–å†™ç”¨ä¾‹è¿›è¡Œåˆ†æï¼Œä¸»è¦è®²è§£ä¸‹åŸºæœ¬æ€è·¯ï¼š

```js
function insertField(val) {
  // åˆ é™¤å…‰æ ‡æ‰€åœ¨ä½ç½®çš„å­—ç¬¦ï¼Œè¿™é‡Œåˆ é™¤ } å­—ç¬¦
  editor.value.cmd.do('forwardDelete')
  // è·å–ä½ç½®
  let startOffset = document.getSelection().focusOffset
  // å½“ ${} ä¸­å­˜åœ¨å·²è¾“å…¥çš„åŒ¹é…å­—ç¬¦æ—¶ï¼Œéœ€è¦è®¡ç®—å¯¹åº”å­—ç¬¦é•¿åº¦
  if (keyword_str.value) {
    startOffset = document.getSelection().focusOffset - keyword_str.value.length
  }

  startOffset -= 2 // è®¡ç®— ${ 2ä¸ªå­—ç¬¦
  startOffset = startOffset < 0 ? 0 : startOffset // ä¸å¯ä¸º è´Ÿæ•°

  // é‡æ–°è®¾ç½®é€‰åŒºä½ç½®
  document
    .getSelection()
    .getRangeAt(0)
    .setStart(
      document.getSelection().focusNode,
      startOffset
    )

  // æ’å…¥å†…å®¹
  editor.value.cmd.do('insertHTML', `<span style="color: blue;">\${${val}}</span>`)
  // æ’å…¥ç©ºç™½å ä½ç¬¦
  editor.value.selection.createEmptyRange()
}
```

åœ¨é€‰ä¸­åˆ—è¡¨ä¸­çš„æŸä¸€é¡¹æ—¶ï¼Œä¼ å…¥ `value`ï¼Œè°ƒç”¨ `insertField` æ–¹æ³•

æŠŠ`value`é€šè¿‡ `${}` è¿›è¡ŒåŒ…è£¹ï¼Œå¾—åˆ° `${value}` è¿™ç§å½¢å¼ï¼ŒåŒæ—¶ä»¥ `span` æ ‡ç­¾è¿›è¡ŒåŒ…è£¹ï¼Œä»¥å®ç°å­—ç¬¦éš”ç¦»ä¸é¢œè‰²é«˜äº®

è¿™é‡Œçš„é‡ç‚¹æ˜¯å¦‚ä½•æ°å¥½æ›¿æ¢ç¼–è¾‘å™¨ä¸­çš„ ${} æ–‡æœ¬ï¼Œé€šè¿‡ `Range` å¯¹è±¡çš„ `setStart` æ–¹æ³•ï¼Œå¯ä»¥é‡æ–°è®¾ç½®èµ·å§‹ä½ç½®ï¼Œ

è¿™é‡Œè®¡ç®— `${}` çš„å‰2ä¸ªå­—ç¬¦ï¼Œå¾—åˆ° -2 çš„ç»“æœï¼ŒåŒæ—¶åˆ é™¤æœ«å°¾çš„ `}` å­—ç¬¦ï¼Œç„¶åå†æŠŠç»“æœé‡æ–°æ’å…¥åˆ°ç¼–è¾‘å™¨ä¸­å³å¯

`editor.cmd.do` æ˜¯ wangeditor åŸºäº `document.execCommand` æ–¹æ³•åšçš„ä¸€å±‚å°è£…ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œç›¸å…³ä»£ç è§ [wangEditor/blob/v4.7.13/src/editor/command.ts](https://github1s.com/wangeditor-team/wangEditor/blob/v4.7.13/src/editor/command.ts)

æœ€åä¸€è¡Œçš„æ’å…¥ç©ºç™½å ä½ç¬¦ `createEmptyRange` ä»£ç ç®€è¦è¯´æ˜ä¸‹ï¼š

1. å¯Œæ–‡æœ¬ç¼–è¾‘å™¨é»˜è®¤æ˜¯é€šè¿‡ `<br>` å……å½“ä¸€ä¸ªç©ºå ä½ç¬¦çš„ï¼Œåˆå§‹ç»“æ„ä¸€èˆ¬æ˜¯ `<p><br></p>`ï¼ŒF12æŸ¥çœ‹DOMç»“æ„å¯çŸ¥ï¼ˆ<br>æ ‡ç­¾ç”¨æ¥å ä½ï¼Œæœ‰å†…å®¹è¾“å…¥åä¼šè‡ªåŠ¨åˆ é™¤ï¼‰
2. åœ¨å¯ç¼–è¾‘çŠ¶æ€ä¸‹ï¼Œå›è½¦æ¢è¡Œäº§ç”Ÿçš„æ–°ç»“æ„ä¼šé»˜è®¤æ‹·è´ä¹‹å‰çš„å†…å®¹ï¼ŒåŒ…æ‰©èŠ‚ç‚¹ï¼Œç±»åç­‰å„ç§å†…å®¹

è¿™é‡Œæ’å…¥ç©ºç™½å ä½ç¬¦çš„ä¸»è¦ä½œç”¨ï¼š

1. æŠŠå…‰æ ‡ç§»å‡ºåˆ°åŒ…è£¹å˜é‡çš„ span æ ‡ç­¾å¤–é¢
2. ç¼–è¾‘å™¨å†…å›è½¦æ¢è¡Œä¸ä¼šå¤åˆ¶ span æ ‡ç­¾å½±å“å†…å®¹ç¼–è¾‘

> wangeditor ä¸­å¯¹äº `createEmptyRange` çš„å®ç°ï¼Œä¸»è¦é€»è¾‘ä¸º `editor.cmd.do('insertHTML', '&#8203;')`

## æ”¯æŒå˜é‡çš„åŠ¨æ€æ¨¡ç³ŠæŸ¥è¯¢

å¯é€‰åˆ—è¡¨ï¼Œå½“å­˜åœ¨å¾ˆå¤šæ¡æ•°æ®æ—¶ï¼Œå†é€šè¿‡é¼ æ ‡ä¸€ä¸ªä¸ªæ‰¾å°±å¾ˆä¸å‹å¥½äº†ï¼Œå› æ­¤ï¼Œæ¨¡ç³ŠæŸ¥è¯¢ä¹Ÿæ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼Œé‚£ä¹ˆï¼Œåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•è®¾è®¡å’Œå®ç°å‘¢ï¼Ÿ

é¦–å…ˆï¼Œéœ€è¦ç¡®å®šçš„æ˜¯å¦‚ä½•é”å®šè¾“å…¥åŒºåŸŸï¼Œæœ‰è¿™ä¹ˆå‡ ç§æƒ…å†µï¼š

1. åœ¨ç¼–è¾‘å™¨æ–‡æœ¬æœ«å°¾è¾“å…¥
2. åœ¨ç¼–è¾‘å™¨ä»»æ„ä¸€è¡Œçš„ä»»æ„ä½ç½®è¾“å…¥

è¿™é‡Œæˆ‘ä»¬æ’é™¤äº†ç¼–è¾‘å™¨çš„ `onChange` æ–¹æ³•ï¼Œå¯¹äºæ–‡æœ¬å†…ä»»æ„ä½ç½®æ’å…¥ç¼–è¾‘éš¾ä»¥ç¡®å®šè¾“å…¥ï¼ŒåŒæ—¶ä¹Ÿä¸ºäº†åœ¨é¼ æ ‡æˆ–è€…é”®ç›˜æ–¹å‘é”®ç§»åŠ¨åˆ°å˜é‡åŒºåŸŸæ—¶èƒ½å¤Ÿæœ‰æ›´å¥½çš„äº¤äº’å“åº”ï¼Œæˆ‘é€‰æ‹©äº† `selectionchange` äº‹ä»¶ï¼Œç›‘å¬å…‰æ ‡é€‰åŒºã€‚

```js
document.removeEventListener('selectionchange', selectionchange)

function selectionchange() {
  const selection = document.getSelection()
  const range = selection.getRangeAt(0)
  // console.log('range', range)
}
```

é€šè¿‡ selection å¯¹è±¡è·å¾—çš„ range å¯¹è±¡æ‰æ˜¯æˆ‘ä»¬æ“ä½œå…‰æ ‡çš„é‡ç‚¹ã€‚Rangeè¡¨ç¤ºåŒ…å«èŠ‚ç‚¹å’Œéƒ¨åˆ†æ–‡æœ¬èŠ‚ç‚¹çš„æ–‡æ¡£ç‰‡æ®µã€‚

### 1. ç¡®å®šå…‰æ ‡ä½ç½®ï¼ŒæŸ¥æ‰¾ ${}

Rangeå¯¹è±¡çš„ startContainer , endContainer, commonAncestorContaineréƒ½ä¸º #text æ–‡æœ¬èŠ‚ç‚¹ï¼Œå¯¹äºæˆ‘ä»¬çš„åœºæ™¯æ¥è¯´å¹¶æ— æ˜æ˜¾åŒºåˆ«ï¼Œè¿™é‡Œæˆ‘ä»¬åªæŸ¥æ‰¾ ${} åŒ…è£¹çš„æƒ…å†µï¼Œä¸è€ƒè™‘è·¨å¤šä¸ªæ–‡æœ¬èŠ‚ç‚¹çš„å¤æ‚åœºæ™¯ï¼Œåªå›´ç»•å½“å‰å•ä¸ªæ–‡æœ¬èŠ‚ç‚¹å¤„ç†å³å¯ã€‚

startOffset å’Œ endOffset åœ¨éæ‰˜é€‰çš„æƒ…å†µä¸‹ï¼Œèµ·å§‹å’Œç»ˆç‚¹å€¼æ˜¯ä¸€æ ·çš„ï¼Œå¯¹äºæ‹–é€‰æƒ…å†µæ¥è¯´ï¼Œæˆ‘ä»¬çš„å¤„ç†æ–¹å¼ä¹Ÿæ²¡ä»€ä¹ˆåŒºåˆ«ï¼ˆæ‹–é€‰çš„åœºæ™¯åŸºæœ¬ä¹Ÿå¯ä»¥ä¸ç”¨è€ƒè™‘ï¼‰

é‚£ä¹ˆæœ‰ä¸€ç‚¹éœ€è¦ç¡®å®šçš„å°±æ˜¯ï¼š**æˆ‘å½“å‰çš„å…‰æ ‡æ˜¯å¦å¤„äº ${} ä¹‹ä¸­ï¼Ÿ**

æ¢ä¸ªè§’åº¦æ€è€ƒï¼Œæˆ‘ä»¬çœ‹ä¸‹å…‰æ ‡å¤„äº ${} ä¹‹ä¸­æ˜¯æ€æ ·çš„ï¼š

1. å…‰æ ‡çš„å·¦è¾¹åº”è¯¥æ˜¯ ${
2. å…‰æ ‡çš„å³è¾¹åº”è¯¥æ˜¯ }

> åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬åœ¨è§¦å‘ $ æ—¶ï¼Œè‡ªåŠ¨æ‹¼æ¥äº† {} ï¼Œä»è€Œå®Œæˆäº† ${} è¿™æ ·çš„ç»„åˆï¼Œè¿™æ ·å¯ä»¥å¾ˆå¥½çš„ä¿è¯ç”¨æˆ·è¾“å…¥çš„ä¸€è‡´æ€§ï¼Œæ–¹ä¾¿æˆ‘ä»¬åé¢çš„è¯†åˆ«å¤„ç†ã€‚

```js
// è·å–å½“å‰æ–‡æœ¬èŠ‚ç‚¹çš„ value
const value = range.commonAncestorContainer.data
// åªæœ‰åœ¨å½“å‰æ–‡æœ¬åŒ…å«æœ‰ $ æ—¶ï¼Œæ‰è€ƒè™‘è¿›ä¸€æ­¥å¤„ç†
if (value && value.indexOf('$') > -1) {
    // 1. æŸ¥æ‰¾ ${}
    // startOffsetã€endOffset ä¸€èˆ¬æƒ…å†µä¸‹éƒ½æ˜¯ç›¸åŒçš„ï¼Œæ²¡æœ‰æ‹–é€‰æ—¶ï¼Œèµ·ç»ˆä½ç½®ä¸€è‡´
    let start = range.startOffset // 
    let end = range.endOffset
    // å‘å·¦æŸ¥æ‰¾æœ€è¿‘çš„ ${ 
    while (start > -1) {
      if (value[start - 1] === '$' && value[start] === '{') {
        break
      }
      start--
    }
    // å‘å³æŸ¥æ‰¾æœ€è¿‘çš„ }
    while (end < value.length + 1) {
      if (value[end] === '}') {
        break
      }
      end++
    }

    // 2. ç¡®å®šå…‰æ ‡ä½ç½®æ˜¯å¦åœ¨ ${} å†…
    if ((range.startOffset > start && start >= 0) && (range.endOffset <= end && end <= value.length)) {
      // ...
    }
}
```

é€šè¿‡ä¸Šè¿°ä»£ç ï¼Œå¯ä»¥ç¡®å®šç¬¦åˆæ¡ä»¶çš„ start ä¸ end çš„å€¼ï¼Œå³ ${ å’Œ } çš„èµ·ç‚¹å’Œç»ˆç‚¹ã€‚

é‚£ä¹ˆä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬å–åˆ°é‡Œé¢çš„å€¼ï¼Œè¿›è¡Œè¿‡æ»¤æŸ¥æ‰¾å³å¯

### 2. æŸ¥æ‰¾å…³é”®å­—

æ¯”å¦‚æˆ‘è¾“å…¥ `${start}`ï¼Œé‚£ä¹ˆå–å€¼å°±æ˜¯ startï¼Œ

ä¸”åˆ—è¡¨æ•°æ®ä¸­åŒ…å« startTimeã€startGameã€endTimeã€endGame è¿™äº›å€¼ï¼Œé‚£ä¹ˆè¿‡æ»¤æŸ¥è¯¢ç¬¦åˆåŒ¹é…çš„åº”è¯¥æœ‰ startTimeã€startGame

`const currentStr = value.slice(start + 1, end)`

å…ˆå¾—åˆ° currentStr å€¼ï¼Œå¹¶ç¼“å­˜åˆ° `keyword_str.value = currentStr`ï¼Œç”¨äºæ’å…¥æ›¿æ¢æ–‡æœ¬æ—¶è®¡ç®—ä½ç½®ä½¿ç”¨

```js
if ((range.startOffset > start && start >= 0) && (range.endOffset <= end && end <= value.length)) {
  const currentStr = value.slice(start + 1, end)
  // åµŒå¥—çš„ä¸å¤„ç†
  if (currentStr.indexOf('$') > -1 || currentStr.indexOf('{') > -1 || currentStr.indexOf('}') > -1) return

  // 3. å¤„ç†å…³é”®å­—åŒ¹é…
  // ç¼“å­˜å…³é”®å­—ï¼Œç”¨äºæ’å…¥æ›¿æ¢æ–‡æœ¬æ—¶è®¡ç®—ä½ç½®
  keyword_str.value = currentStr

  // è¿‡æ»¤åŒ¹é…æ¨¡ç³ŠæŸ¥æ‰¾
  const options = listData.value.filter(n => n.value.toLowerCase().includes(currentStr.toLowerCase()))
  tipOptions.value = clonedeep(options)

  // æ‰“å¼€å¼¹çª—
  // isShow.value = true
} else {
  // ä¸ç¬¦åˆæ¡ä»¶æ—¶ï¼Œå…³é—­å¼¹çª—ï¼Œæ¸…ç©ºæ•°æ®
  isShow.value = false
  tipOptions.value = []
}
```

### åŠ¨æ€è®¡ç®—å¼¹çª—ä½ç½®

æˆ‘æƒ³è¦çš„æ•ˆæœæ˜¯ç±»ä¼¼ VsCode ä»£ç æç¤ºé‚£ç§ï¼Œå½“æˆ‘åœ¨è¾“å…¥æ—¶ï¼Œå¼¹çª—çš„ä½ç½®åº”è¯¥æ˜¯å§‹ç»ˆè·Ÿéšæˆ‘å…‰æ ‡çš„ä½ç½®ä¸‹é¢çš„

è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ç»å¯¹å®šä½absoluteï¼Œåªéœ€è¦è€ƒè™‘ top å€¼å³å¯ï¼Œä½¿ç”¨ `getBoundingClientRect` æ–¹æ³•å¿«é€Ÿå®ç°

```js
// 4. å¼¹çª—é«˜åº¦å¤„ç†

// å¼¹çª— top å€¼ï¼ˆä¸ºäº†å¼¹çª—å§‹ç»ˆè·Ÿéšå…‰æ ‡æ‰€åœ¨ä½ç½®ï¼‰
const boxTop = ref(42)

const editorDomRect = editorBox.value.getBoundingClientRect() // å¯Œæ–‡æœ¬å®¹å™¨
const textNodeRect = selection.focusNode.parentNode.getBoundingClientRect() // æ–‡æœ¬èŠ‚ç‚¹
const top = textNodeRect.top - editorDomRect.top // è®¡ç®—å·®å€¼
// 1ï¼‰éœ€è¦è€ƒè™‘æœ‰çš„ä¸€ä¸²æ–‡æœ¬å¾ˆé•¿ï¼Œå¯èƒ½æ¨ªæ¡†å‡ è¡Œï¼Œä½†æ˜¯å±äºä¸€ä¸ªæ–‡æœ¬èŠ‚ç‚¹ï¼Œå› æ­¤ï¼Œéœ€è¦è€ƒè™‘ textNodeRect.height 
// 2ï¼‰è€ƒè™‘å¯Œæ–‡æœ¬å·¥å…·æ çš„é«˜åº¦ 42
boxTop.value = top + textNodeRect.height + 42
```

ä¸€åˆ‡å°±ç»ªï¼Œæ§åˆ¶å¼¹çª—çš„å¼€å¯å’Œå…³é—­

æ˜¯çš„ï¼Œä¸Šé¢æˆ‘ä»¬åˆ é™¤äº†åœ¨é”®ç›˜äº‹ä»¶è¾“å…¥ $ æ—¶è§¦å‘å¼€å¯å¼¹çª—çš„é€»è¾‘ï¼Œæ”¾åœ¨äº†è¿™é‡Œï¼Œæƒ³å¿…çœ‹åˆ°è¿™é‡Œï¼Œä½ åº”è¯¥ç†è§£äº†åœ¨ selectiononchange ä¸­è¿›è¡Œå¤„ç†çš„å¥½å¤„ï¼Œå°¤å…¶æ˜¯é’ˆå¯¹æˆ‘ä»¬çš„è¿™ä¸ªåœºæ™¯æ¥è¯´ã€‚

```js
if ((range.startOffset > start && start >= 0) && (range.endOffset <= end && end <= value.length)) {
  // ...

  // æ‰“å¼€å¼¹çª—
  isShow.value = true
} else {
  // ä¸ç¬¦åˆæ¡ä»¶æ—¶ï¼Œå…³é—­å¼¹çª—ï¼Œæ¸…ç©ºæ•°æ®
  isShow.value = false
  tipOptions.value = []
}
```

å®Œæ•´çš„ä»£ç ï¼Œåœ°å€å·²æ”¾åœ¨ä¸‹é¢äº†ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥è¿›ä¸€æ­¥æŸ¥çœ‹~

## ç©ºç™½ç¬¦çš„éš”ç¦»ä¼˜åŒ–å¤„ç†

å…¶å®ï¼Œåˆ°è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬åŸºæœ¬å®ç°äº†ç›¸å…³åŠŸèƒ½ã€‚è¿‡ï¼Œå¯¹äºç›®å‰è¿™ç§åŸºäºåŸç”Ÿæ¥å£å®ç°çš„å¯Œæ–‡æœ¬ç¼–è¾‘å™¨æ–¹æ¡ˆï¼Œè¿˜æ˜¯å­˜åœ¨ä¸€ä¸ªéå¸¸å½±å“ä½“éªŒçš„åœ°æ–¹éœ€è¦å¤„ç†ä¼˜åŒ–ã€‚

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å®ç°äº†æ’å…¥é€»è¾‘ï¼Œä¸æ­¤åŒæ—¶æˆ‘ä»¬éœ€è¦åŒæ­¥åˆ›å»ºä¸€ä¸ªç©ºç™½èŠ‚ç‚¹ï¼Œå¹¶ä½¿å…‰æ ‡å‘åç§»åŠ¨ä¸€ä½ï¼Œä¸ºçš„æ˜¯åœ¨å¯Œæ–‡æœ¬çš„é€»è¾‘ä¸­ï¼Œæ’å…¥æ–‡æœ¬åä¸å½±å“åé¢çš„è¾“å…¥ã€‚

è™½ç„¶ç©ºç™½èŠ‚ç‚¹ä¸å¯è§ï¼Œä½†æ˜¯åœ¨æˆ‘ä»¬é€šè¿‡é¼ æ ‡ç‚¹å‡»çš„æ—¶å€™ï¼Œä¼šå‡ºç°è¿™ä¹ˆä¸€ç§æƒ…å†µï¼Œåœ¨ç‚¹å‡»ä¹‹åï¼Œå…‰æ ‡çš„ä½ç½®å®é™…ä¸Šæ˜¯ç§»åŠ¨åˆ°äº†å˜é‡çš„æ–‡æœ¬èŠ‚ç‚¹å†…äº†çš„ï¼Œä¾‹å¦‚ï¼š

`${startTime}abc` è¿™æ®µæ–‡æœ¬

![1](https://cdn.jsdelivr.net/gh/JS-banana/images/vuepress/mte-hint-1.jpg)

åœ¨DOMä¸Šçš„ç»“æ„å®é™…ä¸Šæ˜¯è¿™æ ·çš„

![2](https://cdn.jsdelivr.net/gh/JS-banana/images/vuepress/mte-hint-2.jpg)

å½“æˆ‘åœ¨ `}a` è¿™ä¸¤ä¸ªå­—ç¬¦ä¸­é—´çš„ä½ç½®ç‚¹å‡»ä¸€æ¬¡æ—¶ï¼Œå…‰æ ‡ä¼šç§»åŠ¨åˆ°è¿™é‡Œï¼Œé‚£ä¹ˆä½ è§‰å¾—æˆ‘æ¥ä¸‹æ¥è¾“å…¥å†…å®¹åï¼Œå®ƒä¼šåœ¨å“ªä¸ªèŠ‚ç‚¹ä¸­å‘¢ï¼Ÿ

ç­”æ¡ˆæ˜¯è¿™æ ·çš„ï¼š

1. é’ˆå¯¹ç”¨ä¾‹è¿™æ ·çš„å†…å®¹ï¼Œç»“æœå¹¶ä¸ç»å¯¹ï¼Œå¯èƒ½å’Œæˆ‘ç‚¹çš„ä½ç½®æœ‰å…³ç³»ï¼Œæœ‰æ—¶åœ¨å˜é‡æ–‡æœ¬èŠ‚ç‚¹å†…ï¼Œæœ‰æ—¶ä¸åœ¨ï¼Œçœ‹ä¼¼æ­£å¸¸ï¼Œä½†æ˜¯è¿™æ ·çš„ç»“æœéå¸¸ä¸å¯é ï¼Œä¸æ˜¯æˆ‘ä»¬æ‰€èƒ½æ§åˆ¶çš„
2. å¯¹äº `${startTime}` è¿™æ ·çš„æ–‡æœ¬ï¼Œä½äºæ–‡æœ¬æœ«å°¾æ—¶ï¼ŒåŸºæœ¬ä¸Šæ˜¯éå¸¸ç¡®å®šçš„ï¼Œåœ¨ç‚¹å‡»åï¼Œä¼šè·‘åˆ° span æ ‡ç­¾ä¸­â€”â€”æˆ‘ä»¬çš„å˜é‡æ–‡æœ¬èŠ‚ç‚¹å†…

## æ€»ç»“

## demoåœ°å€

## èµ„æ–™

- [é€‰æ‹©ï¼ˆSelectionï¼‰å’ŒèŒƒå›´ï¼ˆRangeï¼‰](https://zh.javascript.info/selection-range)
- [JavaScriptä¸­å¯¹å…‰æ ‡å’Œé€‰åŒºçš„æ“ä½œ](https://segmentfault.com/a/1190000040211043)
- [document.execCommand](https://developer.mozilla.org/zh-CN/docs/Web/API/Document/execCommand)
- [web dom apiä¸­çš„Selectionå’ŒRange](https://www.cnblogs.com/kidsitcn/p/11628822.html)
- [https://www.wangeditor.com/v5/](https://www.wangeditor.com/v5/)
- [ğŸ‰ å¯Œæ–‡æœ¬ç¼–è¾‘å™¨åˆæ¢](https://juejin.cn/post/6955335319566680077)
- [åˆ©ç”¨ javascript å®ç°å¯Œæ–‡æœ¬ç¼–è¾‘å™¨](https://juejin.cn/post/6844903508446019597)
